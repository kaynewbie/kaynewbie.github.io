<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  
  <title>iOS 开发者入坑 Flutter 只是迁移(译) | Kai的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="此文档用于帮助 iOS 开发者将现有的 iOS 知识运用到 Flutter 移动应用开发中。如果已经掌握 iOS 框架的基础，能快速通过此篇文章上手 Flutter 开发。 阅读本文前，最好花 15 分钟看完以下关于 Cupertino 的视频。 Flutter 依赖大量的手机操作系统的能力和配置，因此，iOS 技能在开发中会起到很大帮助。Flutter 是一种开发移动 UI 的新方式，但它有额外">
<meta name="keywords" content="flutter,ios,dart">
<meta property="og:type" content="article">
<meta property="og:title" content="iOS 开发者入坑 Flutter 只是迁移(译)">
<meta property="og:url" content="https://kaynewbie.github.io/2019/07/28/flutter-for-ios-developers/index.html">
<meta property="og:site_name" content="Kai的博客">
<meta property="og:description" content="此文档用于帮助 iOS 开发者将现有的 iOS 知识运用到 Flutter 移动应用开发中。如果已经掌握 iOS 框架的基础，能快速通过此篇文章上手 Flutter 开发。 阅读本文前，最好花 15 分钟看完以下关于 Cupertino 的视频。 Flutter 依赖大量的手机操作系统的能力和配置，因此，iOS 技能在开发中会起到很大帮助。Flutter 是一种开发移动 UI 的新方式，但它有额外">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-07-28T14:12:55.281Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="iOS 开发者入坑 Flutter 只是迁移(译)">
<meta name="twitter:description" content="此文档用于帮助 iOS 开发者将现有的 iOS 知识运用到 Flutter 移动应用开发中。如果已经掌握 iOS 框架的基础，能快速通过此篇文章上手 Flutter 开发。 阅读本文前，最好花 15 分钟看完以下关于 Cupertino 的视频。 Flutter 依赖大量的手机操作系统的能力和配置，因此，iOS 技能在开发中会起到很大帮助。Flutter 是一种开发移动 UI 的新方式，但它有额外">
  
    <link rel="alternate" href="/atom.xml" title="Kai的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Kai的博客</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://kaynewbie.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-flutter-for-ios-developers" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/28/flutter-for-ios-developers/" class="article-date">
  <time datetime="2019-07-28T14:10:33.000Z" itemprop="datePublished">2019-07-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      iOS 开发者入坑 Flutter 只是迁移(译)
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>此文档用于帮助 iOS 开发者将现有的 iOS 知识运用到 Flutter 移动应用开发中。如果已经掌握 iOS 框架的基础，能快速通过此篇文章上手 Flutter 开发。</p>
<p>阅读本文前，最好花 15 分钟看完以下关于 <a href="https://www.youtube.com/flutterdev" target="_blank" rel="noopener">Cupertino</a> 的视频。</p>
<p>Flutter 依赖大量的手机操作系统的能力和配置，因此，iOS 技能在开发中会起到很大帮助。Flutter 是一种开发移动 UI 的新方式，但它有额外的插件系统在非 UI 任务上，和操作系统（iOS &amp; Android）交流。iOS 开发专家不需要了解 Flutter 的所有东西。</p>
<p>当运行在 iOS 系统上时，Flutter 已经为此做了一些调整。更多可查看<a href="https://flutter.dev/docs/resources/platform-adaptations" target="_blank" rel="noopener">平台兼容性</a>。</p>
<p>开发过程中，遇到问题时，此文档可作为参考书查看。</p>
<a id="more"></a>

<ul>
<li><a href="#%e8%a7%86%e5%9b%be">视图</a><ul>
<li><a href="#flutter-%e4%b8%ad%e5%92%8c-uiview-%e7%ad%89%e4%bb%b7%e7%9a%84%e4%b8%9c%e8%a5%bf">Flutter 中和 UIView 等价的东西</a></li>
<li><a href="#%e5%a6%82%e4%bd%95%e6%9b%b4%e6%96%b0-widgets">如何更新 widgets</a></li>
<li><a href="#widgets-%e5%a6%82%e4%bd%95%e5%b8%83%e5%b1%80%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8-sb">widgets 如何布局？如何使用 SB？</a></li>
<li><a href="#%e5%a6%82%e4%bd%95%e6%b7%bb%e5%8a%a0%e6%88%96%e7%a7%bb%e9%99%a4%e5%b8%83%e5%b1%80%e4%b8%ad%e7%9a%84%e7%bb%84%e4%bb%b6">如何添加或移除布局中的组件</a></li>
<li><a href="#%e5%a6%82%e4%bd%95%e4%b8%ba-widget-%e6%b7%bb%e5%8a%a0%e5%8a%a8%e7%94%bb">如何为 widget 添加动画</a></li>
<li><a href="#%e5%a6%82%e4%bd%95%e8%bf%9b%e8%a1%8c%e5%b1%8f%e5%b9%95%e7%bb%98%e5%88%b6">如何进行屏幕绘制</a></li>
<li><a href="#widget-%e9%80%8f%e6%98%8e%e5%ba%a6">widget 透明度</a></li>
<li><a href="#%e5%a6%82%e4%bd%95%e8%87%aa%e5%ae%9a%e4%b9%89-widgets">如何自定义 widgets</a></li>
</ul>
</li>
<li><a href="#%e5%af%bc%e8%88%aa">导航</a><ul>
<li><a href="#%e9%a1%b5%e9%9d%a2%e5%af%bc%e8%88%aa">页面导航</a></li>
<li><a href="#%e5%a6%82%e4%bd%95%e5%af%bc%e8%88%aa%e5%88%b0%e5%85%b6%e4%bb%96%e9%a1%b5%e9%9d%a2">如何导航到其他页面</a></li>
<li><a href="#%e5%a6%82%e4%bd%95%e8%bf%94%e5%9b%9e%e5%88%b0-ios-%e5%8e%9f%e7%94%9f%e6%8e%a7%e5%88%b6%e5%99%a8">如何返回到 iOS 原生控制器</a></li>
</ul>
</li>
<li><a href="#%e7%ba%bf%e7%a8%8b%e5%92%8c%e5%bc%82%e6%ad%a5%e6%93%8d%e4%bd%9c">线程和异步操作</a><ul>
<li><a href="#%e5%a6%82%e4%bd%95%e7%bc%96%e5%86%99%e5%bc%82%e6%ad%a5%e4%bb%a3%e7%a0%81">如何编写异步代码</a></li>
</ul>
</li>
<li><a href="#%e5%b7%a5%e7%a8%8b%e7%bb%93%e6%9e%84%e6%9c%ac%e5%9c%b0%e5%8c%96%e4%be%9d%e8%b5%96%e5%92%8c%e8%b5%84%e6%ba%90">工程结构，本地化，依赖和资源</a><ul>
<li><a href="#flutter-%e4%b8%ad%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8%e5%9b%be%e7%89%87%e8%b5%84%e6%ba%90%e5%a6%82%e4%bd%95%e5%a4%84%e7%90%86%e5%a4%9a%e5%88%86%e8%be%a8%e7%8e%87">Flutter 中如何使用图片资源？如何处理多分辨率？</a></li>
<li><a href="#%e5%a6%82%e4%bd%95%e5%ad%98%e5%82%a8%e5%ad%97%e7%ac%a6%e4%b8%b2%e5%a6%82%e4%bd%95%e5%a4%84%e7%90%86%e6%9c%ac%e5%9c%b0%e5%8c%96">如何存储字符串？如何处理本地化？</a></li>
<li><a href="#cocoapods-%e7%9a%84%e6%9b%bf%e4%bb%a3%e5%93%81%e5%a6%82%e4%bd%95%e6%b7%bb%e5%8a%a0%e4%be%9d%e8%b5%96">CocoaPods 的替代品？如何添加依赖？</a></li>
</ul>
</li>
<li><a href="#%e8%a7%86%e5%9b%be%e6%8e%a7%e5%88%b6%e5%99%a8">视图控制器</a><ul>
<li><a href="#flutter-%e4%b8%ad%e8%a7%86%e5%9b%be%e6%8e%a7%e5%88%b6%e5%99%a8%e7%9a%84%e6%9b%bf%e4%bb%a3%e5%93%81">Flutter 中视图控制器的替代品</a></li>
<li><a href="#%e5%a6%82%e4%bd%95%e7%9b%91%e5%90%ac-ios-%e7%94%9f%e5%91%bd%e5%91%a8%e6%9c%9f%e4%ba%8b%e4%bb%b6">如何监听 iOS 生命周期事件</a></li>
</ul>
</li>
<li><a href="#%e5%b8%83%e5%b1%80">布局</a><ul>
<li><a href="#flutter-%e4%b8%ad-uitableview-%e5%92%8c-uicollectionview-%e7%9a%84%e6%9b%bf%e4%bb%a3%e5%93%81">Flutter 中 UITableView 和 UICollectionView 的替代品</a></li>
<li><a href="#listview-%e5%88%97%e8%a1%a8%e9%80%89%e4%b8%ad">ListView 列表选中</a></li>
<li><a href="#%e5%a6%82%e4%bd%95%e5%8a%a8%e6%80%81%e6%9b%b4%e6%96%b0-listview">如何动态更新 ListView</a></li>
<li><a href="#scrollview-%e6%9b%bf%e4%bb%a3%e5%93%81">ScrollView 替代品</a></li>
</ul>
</li>
<li><a href="#%e6%89%8b%e5%8a%bf%e6%a3%80%e6%b5%8b%e5%92%8c%e8%a7%a6%e6%91%b8%e4%ba%8b%e4%bb%b6%e5%a4%84%e7%90%86">手势检测和触摸事件处理</a><ul>
<li><a href="#%e5%a6%82%e4%bd%95%e6%b7%bb%e5%8a%a0%e4%b8%aa%e7%82%b9%e5%87%bb%e7%9b%91%e5%90%ac">如何添加个点击监听</a></li>
<li><a href="#%e5%a6%82%e4%bd%95-widgets-%e4%b8%8a%e7%9a%84%e5%85%b6%e5%ae%83%e4%ba%8b%e4%bb%b6">如何 widgets 上的其它事件</a></li>
</ul>
</li>
<li><a href="#%e4%b8%bb%e9%a2%98%e5%8c%96%e5%92%8c%e6%96%87%e6%9c%ac">主题化和文本</a><ul>
<li><a href="#%e5%a6%82%e4%bd%95%e4%b8%ba%e5%ba%94%e7%94%a8%e5%88%9b%e5%bb%ba%e4%b8%bb%e9%a2%98">如何为应用创建主题</a></li>
<li><a href="#%e4%b8%ba-text-%e8%87%aa%e5%ae%9a%e4%b9%89%e5%ad%97%e4%bd%93">为 Text 自定义字体</a></li>
<li><a href="#%e8%87%aa%e5%ae%9a%e4%b9%89-text-%e9%a3%8e%e6%a0%bc">自定义 Text 风格</a></li>
</ul>
</li>
<li><a href="#%e8%a1%a8%e5%8d%95%e8%be%93%e5%85%a5">表单输入</a><ul>
<li><a href="#flutter-%e4%b8%ad%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8%e8%a1%a8%e5%8d%95%e5%a6%82%e4%bd%95%e8%8e%b7%e5%8f%96%e7%94%a8%e6%88%b7%e8%be%93%e5%85%a5">Flutter 中如何使用表单？如何获取用户输入？</a></li>
<li><a href="#text-field-%e5%8d%a0%e4%bd%8d%e6%96%87%e5%ad%97%e7%9a%84%e6%9b%bf%e4%bb%a3%e5%93%81">Text field 占位文字的替代品？</a></li>
<li><a href="#%e5%a6%82%e4%bd%95%e5%b1%95%e7%a4%ba%e6%a0%a1%e9%aa%8c%e9%94%99%e8%af%af">如何展示校验错误？</a></li>
</ul>
</li>
<li><a href="#%e7%a1%ac%e4%bb%b6%e4%ba%a4%e4%ba%92%e7%ac%ac%e4%b8%89%e6%96%b9%e6%9c%8d%e5%8a%a1%e5%92%8c%e5%b9%b3%e5%8f%b0">硬件交互，第三方服务和平台</a><ul>
<li><a href="#%e5%a6%82%e4%bd%95%e4%b8%8e%e5%b9%b3%e5%8f%b0%e4%bb%a5%e5%8f%8a%e5%8e%9f%e7%94%9f%e4%bb%a3%e7%a0%81%e4%ba%a4%e4%ba%92">如何与平台以及原生代码交互</a></li>
<li><a href="#%e5%a6%82%e4%bd%95%e8%8e%b7%e5%8f%96-gps-%e6%84%9f%e5%ba%94%e5%99%a8">如何获取 GPS 感应器？</a></li>
<li><a href="#%e5%a6%82%e4%bd%95%e8%8e%b7%e5%8f%96%e7%9b%b8%e6%9c%ba">如何获取相机？</a></li>
<li><a href="#%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8-fb-%e7%99%bb%e5%bd%95">如何使用 FB 登录？</a></li>
<li><a href="#%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8-firebase-%e7%89%b9%e6%80%a7">如何使用 Firebase 特性？</a></li>
<li><a href="#%e5%a6%82%e6%9e%9c%e6%9e%84%e5%bb%ba%e8%87%aa%e5%ae%9a%e4%b9%89%e5%8e%9f%e7%94%9f%e9%9b%86%e6%88%90">如果构建自定义原生集成？</a></li>
</ul>
</li>
<li><a href="#%e6%95%b0%e6%8d%ae%e5%ba%93%e5%92%8c%e6%9c%ac%e5%9c%b0%e5%ad%98%e5%82%a8">数据库和本地存储</a><ul>
<li><a href="#%e5%a6%82%e4%bd%95%e8%ae%bf%e9%97%ae-userdefault">如何访问 UserDefault？</a></li>
<li><a href="#coredata-%e7%9a%84%e6%9b%bf%e4%bb%a3%e5%93%81">CoreData 的替代品？</a></li>
</ul>
</li>
<li><a href="#%e8%b0%83%e8%af%95">调试</a><ul>
<li><a href="#flutter-app-%e8%b0%83%e8%af%95%e5%b7%a5%e5%85%b7">Flutter app 调试工具？</a></li>
</ul>
</li>
<li><a href="#%e9%80%9a%e7%9f%a5%e6%8e%a8%e9%80%81">通知推送</a><ul>
<li><a href="#%e5%a6%82%e4%bd%95%e8%ae%be%e7%bd%ae%e6%8e%a8%e9%80%81%e6%b6%88%e6%81%af">如何设置推送消息？</a></li>
</ul>
</li>
</ul>
<h1 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h1><h2 id="Flutter-中和-UIView-等价的东西"><a href="#Flutter-中和-UIView-等价的东西" class="headerlink" title="Flutter 中和 UIView 等价的东西"></a>Flutter 中和 UIView 等价的东西</h2><p>iOS 中，通常用 <code>UIView</code> 创建 UI，且 <code>UIView</code> 之间可互相嵌套，以此构成布局。</p>
<p>可粗略地将 Flutter 中的 <code>Widget</code> 等价于 <code>UIView</code>。Widgets 并不完全匹配 iOS 视图，但当你明白 Flutter 工作原理后，可把它当作声明和构建 UI 的方式。</p>
<p>Widgets 和 <code>UIView</code> 的一些不同之处。首先，widgets 声明周期不同：不可变且一直存在，直到需要改变。每当 widgets 或其状态发生变化时，Flutter 框架都会创建一个新的 widget 实例树。相比之下，iOS 视图改变时不会重新创建，重绘的是可变实体（mutable entity），可变实体一旦绘制，只有调用 <code>setNeedsDisplay()</code> 重新绘制。</p>
<p>此外，不像 <code>UIView</code>，Flutter widgets 是轻量的，部分原因在于它们是不可变的。因为它们本身不是视图，并且不是直接绘制任何东西，而是对 UI 及其语义的描述，这些描述在内部被映射到真正的视图对象上。</p>
<p>Flutter 包含 <code>Material</code> 组件库。<code>Material</code> 库的 widgets 按照 <em>Material Desing guidelines</em> 实现。Material Design 是一个弹性的设计系统，为所有平台做了优化，包括 iOS。</p>
<p>Flutter 有足够的灵活性和便捷性去实现任意设计。iOS 上可使用 <code>Cupertino widgets</code> 生成符合 <a href="https://developer.apple.com/design/resources" target="_blank" rel="noopener">Apple’s iOS design language</a> 的界面。</p>
<h2 id="如何更新-widgets"><a href="#如何更新-widgets" class="headerlink" title="如何更新 widgets"></a>如何更新 widgets</h2><p>iOS 上更新视图的方式就是直接修改。Flutter widgets 不可修改且不能直接更新，必须操作 widget 的状态。</p>
<p>Stateful 和 Stateless widgets 概念就是为了修改视图引入。<code>StatelessWidget</code> 是没有附属状态的 widget。</p>
<p>当程序描述的界面部分元素不依赖于初始配置意外的任何内容时，<code>StatelessWidgets</code> 是非常有用的。</p>
<p>比如，类似 iOS 中，在 <code>UIImageView</code> 内放置一张 logo 图片一样。在 Flutter 中，如果 logo 图片不变，可以使用 <code>StatelessWidget</code>。</p>
<p>如果想实现一个基于 HTTP 请求动态修改 UI 的场景，使用 <code>StatefulWidget</code>。请求完成后，告诉 Flutter 框架 widget <code>State</code> 已经更新，框架会自动更新 UI。</p>
<p>Stateful 和 Stateless 最大的区别是，<code>StatefuleWidgets</code> 有一个 State 对象，此对象存储状态数据，并在树重构的过程中一直携带。</p>
<p>如果还没理解上述内容，记住以下规则：如果 widget 在 <code>build()</code> 方法外改变，那么它就是 stateful。如果 widget 创建后就不改变，它是 stateless。此外，如果一个 widget 是 stateful，它的父 widget 也可能是 stateless。</p>
<p>以下例子展示如何使用 <code>StatelessWidget</code>。<code>Text</code> 是常见的 <code>StatelessWidget</code>。可以查看 <code>Text</code> 类型定义，它是 <code>StatelessWidget</code> 子类。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Text(</span><br><span class="line"><span class="string">'I like Flutter!'</span>,</span><br><span class="line">style: TextStyle(fontWeight: FontWeight.bold),</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>从上述代码发现， <code>Text</code> 并没有携带显式的状态，只靠构造器的参数渲染。</p>
<p>但是，如何动态修改 <code>Text</code> 展示文本？</p>
<p>解决上述问题，将 <code>Text</code> 包装在一个 <code>StatefulWidget</code> 中。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SampleApp</span> <span class="title">extend</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">    <span class="meta">@override</span></span><br><span class="line">    Widget build(BuildContext context) &#123;</span><br><span class="line">        <span class="keyword">return</span> MaterialApp(</span><br><span class="line">            title: <span class="string">'Sample App'</span>,</span><br><span class="line">            theme: ThemeData(</span><br><span class="line">                primarySwatch: Colors.blue,</span><br><span class="line">            ),</span><br><span class="line">            home: SampleAppPage(),</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SampleAppPage</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">    SampleAppPage(&#123;Key key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@override</span></span><br><span class="line">    _SampleAppPageState createState() =&gt; _SampleAppPageState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_SampleAppPageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">SampleAppPage</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">String</span> textToShow = <span class="string">"I like Flutter"</span>;</span><br><span class="line">    <span class="keyword">void</span> _updateText() &#123;</span><br><span class="line">        setState(() &#123;</span><br><span class="line">            textToShow = <span class="string">"Flutter is Awesome!"</span>;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@override</span></span><br><span class="line">    Widget build(BuildContext context) &#123;</span><br><span class="line">        <span class="keyword">return</span> Scaffold(</span><br><span class="line">            appBar: AppBar(</span><br><span class="line">                title: Text(<span class="string">"Sample App"</span>),</span><br><span class="line">            ),</span><br><span class="line">            body: Center(child: Text(textToShow)),</span><br><span class="line">            floatingActionButton: FloatingActionButton(</span><br><span class="line">                onPressed: _updateText,</span><br><span class="line">                tooltip: <span class="string">'Update Text'</span>,</span><br><span class="line">                child: Icon(Icons.update),</span><br><span class="line">            ),</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="widgets-如何布局？如何使用-SB？"><a href="#widgets-如何布局？如何使用-SB？" class="headerlink" title="widgets 如何布局？如何使用 SB？"></a>widgets 如何布局？如何使用 SB？</h2><p>iOS 支持用 SB 组织视图并设置约束。Flutter 中通过组合 widget 树声明布局。</p>
<p>如下例子展示 widget 那边距：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">        appBar: AppBar(</span><br><span class="line">            title: Text(<span class="string">'Sample App'</span>),</span><br><span class="line">        ),</span><br><span class="line">        body: Center(</span><br><span class="line">            child: CupertinoButton(</span><br><span class="line">                onPressed: () &#123;</span><br><span class="line">                    setState(() &#123;</span><br><span class="line">                        _pressedCount++;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">                child: Text(<span class="string">'Hello'</span>),</span><br><span class="line">                padding: EdgeInsets.only(left: <span class="number">10.0</span>, right: <span class="number">10.0</span>),</span><br><span class="line">            ),</span><br><span class="line">        ),</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>任意 widget 都可添加内边距，类似 iOS 中的约束。</p>
<p>在 <a href="https://flutter.dev/docs/development/ui/widgets/layout" target="_blank" rel="noopener">widget catalog</a> 中查看更多 Flutter 布局信息。</p>
<h2 id="如何添加或移除布局中的组件"><a href="#如何添加或移除布局中的组件" class="headerlink" title="如何添加或移除布局中的组件"></a>如何添加或移除布局中的组件</h2><p>iOS 中，开发者可调用父视图的 <code>addSubview()</code> 方法动态增加子视图，也可以调用子视图的 <code>removeFromSuperview()</code> 方法动态移除子视图。Flutter 中，widgets 是不可变的，并没有直接等价 <code>addSubview()</code> 的方法。</p>
<p>下述例子展示当用户点击按钮时，如何切换两个 widgets：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SampleApp</span> <span class="title">extend</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">    Widget build(BuildContext context) &#123;</span><br><span class="line">        <span class="keyword">return</span> MaterialApp(</span><br><span class="line">            title: <span class="string">'Sample App'</span>,</span><br><span class="line">            theme: ThemeData(</span><br><span class="line">                primarySwatch: Colors.blue,</span><br><span class="line">            ),</span><br><span class="line">            home: SampleAppPage(),</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SampleAppPage</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">    SampleAppPage(&#123;Key key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">    _SampleAppPageState createState() =&gt; _SampleAppPageState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_SampleApppageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">SampleAppPage</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">bool</span> toggle = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">void</span> _toggle() &#123;</span><br><span class="line">        setState(() &#123;</span><br><span class="line">            toggle = !toggle;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> _getToggleChild() &#123;</span><br><span class="line">        <span class="keyword">if</span> (toggle) &#123;</span><br><span class="line">            <span class="keyword">return</span> Text(<span class="string">'Toggle on'</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> CupertinoButton(</span><br><span class="line">                onPressed: () &#123;&#125;,</span><br><span class="line">                child: Text(<span class="string">'Toggle Two'</span>),</span><br><span class="line">            );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Widget build(BuildContext context) &#123;</span><br><span class="line">        <span class="keyword">return</span> Scaffold(</span><br><span class="line">            appbar: Appbar(</span><br><span class="line">                title: Text(<span class="string">'Sample App'</span>),</span><br><span class="line">            ),</span><br><span class="line">            body: Center(</span><br><span class="line">                child: _getToggleChild(),</span><br><span class="line">            ),</span><br><span class="line">            floatingActionButton: FloatingActionButton(</span><br><span class="line">                onPressed: _toggle,</span><br><span class="line">                tooltip: <span class="string">'Update Text'</span>,</span><br><span class="line">                child: Icon(Icons.update),</span><br><span class="line">            ),</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="如何为-widget-添加动画"><a href="#如何为-widget-添加动画" class="headerlink" title="如何为 widget 添加动画"></a>如何为 widget 添加动画</h2><p>iOS 中，调用 UIView <code>animate(withDuration:animations:)</code> 方法生成动画。Flutter 中，将 widget 封装到动画库的 widget 中。</p>
<p>Flutter 使用 <code>Animation&lt;double&gt;</code> 子类 <code>AnimationController</code> 生成动画。<code>Animation&lt;double&gt;</code> 可以暂停、查找、终止和反转动画。动画需要一个 <code>Ticker</code> 对象，此对象负责在 vsync 发生时发送信令，并在运行时每一帧动画中插入一个 0～1 的线性值。一个控制器可以附带一个或多个 <code>Animations</code>。</p>
<p>举个例子，使用 <code>CurvedAnimation</code> 实现一个插值曲线动画。按照这种做法，控制器是动画过程主要的数据来源，<code>CurvedAnimation</code> 计算曲线并替换控制器的默认线性动态。同 widgets，Flutter 中的动画也是可以组合的。</p>
<p>构建 widget 树时，为其中一个 widget 设置一个动画属性，比如 <code>FadeTransition</code> 的透明度，并告诉控制器启动动画。</p>
<p>下述例子展示 FadeTransition 淡出动画：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SampleApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">    <span class="meta">@override</span></span><br><span class="line">    Widget build(BuildContext) &#123;</span><br><span class="line">        <span class="keyword">return</span> MaterialApp(</span><br><span class="line">            title: <span class="string">'Fade Demo'</span>,</span><br><span class="line">            theme: ThemeData(</span><br><span class="line">                primarySwatch: Colors.blue,</span><br><span class="line">            ),</span><br><span class="line">            home: MyFadeTest(title: <span class="string">'Fade Demo'</span>),</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyFadeTest</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">    MyFadeTest(&#123;Key key, <span class="keyword">this</span>.title&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="built_in">String</span> title;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@override</span></span><br><span class="line">    _MyFadeTest createState() =&gt; _MyFadeTest();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_MyFadeTest</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">MyFadeTest</span>&gt; <span class="title">with</span> <span class="title">TickerProviderStateMixin</span> </span>&#123;</span><br><span class="line">    AnimationController controller;</span><br><span class="line">    CurvedAnimation curve;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@override</span></span><br><span class="line">    <span class="keyword">void</span> initState() &#123;</span><br><span class="line">        controller = AnimationController(duration; <span class="keyword">const</span> <span class="built_in">Duration</span>(milliseconds: <span class="number">2000</span>), vsync: <span class="keyword">this</span>);</span><br><span class="line">        curve = CurvedAnimation(parent: controller, curve: Curves.easeIn);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Widget build(BuildContext context) &#123;</span><br><span class="line">        <span class="keyword">return</span> Scaffold(</span><br><span class="line">            appBar: AppBar(</span><br><span class="line">                title: Text(widget.title),</span><br><span class="line">            ),</span><br><span class="line">            body: Center(</span><br><span class="line">                child: Container(</span><br><span class="line">                    FadeTransition(</span><br><span class="line">                        opacity: curve,</span><br><span class="line">                        child: FlutterLogo(</span><br><span class="line">                            size: <span class="number">100.0</span>,</span><br><span class="line">                        ),</span><br><span class="line">                    ),</span><br><span class="line">                ),</span><br><span class="line">            ),</span><br><span class="line">            floatingActionButton: FloatingActionButton(</span><br><span class="line">                tooltip: <span class="string">'Fade'</span>,</span><br><span class="line">                child: Icon(Icons.brush),</span><br><span class="line">                onPressed: () &#123;</span><br><span class="line">                    controller.forward();</span><br><span class="line">                &#125;</span><br><span class="line">            ),</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@override</span></span><br><span class="line">    dispose() &#123;</span><br><span class="line">        controller.dispose();</span><br><span class="line">        <span class="keyword">super</span>.dispose();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="如何进行屏幕绘制"><a href="#如何进行屏幕绘制" class="headerlink" title="如何进行屏幕绘制"></a>如何进行屏幕绘制</h2><p>iOS 中，开发者用 <code>CoreGraphics</code> 绘制线条和形状到屏幕上。Flutter 使用基于 <code>Canvas</code> 类的 API 以及两个辅助类(<code>CustomPaint</code> 和 <code>CustomPainter</code>，后者实现绘制画布的算法)。</p>
<p>Flutter 中，如何实现签名签名画家：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SignaturePainter</span> <span class="keyword">extends</span> <span class="title">CustomPainter</span> </span>&#123;</span><br><span class="line">    SignaturePainter(<span class="keyword">this</span>.points);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="built_in">List</span>&lt;Offset&gt; points;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> paint(Canvas canvas, Size size) &#123;</span><br><span class="line">        <span class="keyword">var</span> paint = Paint()</span><br><span class="line">            ..color = Colors.black</span><br><span class="line">            ..strokeCap = StrokeCap.round</span><br><span class="line">            ..strokeWidth = <span class="number">5.0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; points.length - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (points[i] != <span class="keyword">null</span> &amp;&amp; points[i + <span class="number">1</span>] != <span class="keyword">null</span>) &#123;</span><br><span class="line">                canvas.drawLine(points[i], points[i + <span class="number">1</span>], paint);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">bool</span> shouldRepaint(SingnaturePainter other) =&gt; other.points != points;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Signature</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">    SignatureState createState() =&gt; SignatureState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SignatureState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">Signature</span>&gt; </span>&#123;</span><br><span class="line">    Widget build(BuildContext context) &#123;</span><br><span class="line">        <span class="keyword">return</span> GestureDetector(</span><br><span class="line">            onPanUpdate: (DragUpdateDetails details) &#123;</span><br><span class="line">                setState(() &#123;</span><br><span class="line">                    RenderBox refernceBox = context.findRenderObject();</span><br><span class="line">                    Offset localPosition = referencenBox.globalToLocal(details.globalPosition);</span><br><span class="line">                    _points = <span class="built_in">List</span>.from(_points)</span><br><span class="line">                        ..add(localPosition);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">            onPanEnd: (DragDetails details) =&gt; _points.add(<span class="keyword">null</span>),</span><br><span class="line">            child: CustomPaint(painter: SignaturePainter(_points), size: Size.infinite),</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="widget-透明度"><a href="#widget-透明度" class="headerlink" title="widget 透明度"></a>widget 透明度</h2><p>iOS 视图都有透明度。Flutter 实现透明度需要使用 Opacity widget。</p>
<h2 id="如何自定义-widgets"><a href="#如何自定义-widgets" class="headerlink" title="如何自定义 widgets"></a>如何自定义 widgets</h2><p>iOS 中，重载 <code>UIView</code> 子类或已存在的视图的方法去自定义视图。Flutter 自定义视图由多个更小的 widget 组合而成。</p>
<p>举例，如何创建一个构造器带一个 label 参数的 <code>CustomButton</code>？</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomButton</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="built_in">String</span> label;</span><br><span class="line"></span><br><span class="line">    CustomButton(<span class="keyword">this</span>.label);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@override</span></span><br><span class="line">    Widget build(BuildContext context) &#123;</span><br><span class="line">        <span class="keyword">return</span> RaisedButton(</span><br><span class="line">            onPressed: () &#123;</span><br><span class="line">            <span class="comment">// do something...</span></span><br><span class="line">        &#125;,</span><br><span class="line">        child: Text(label),</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用 <code>CustomButton</code> 时跟其他 widget 一样：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@override</span></span><br><span class="line">Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Center(</span><br><span class="line">        child: CustomButton(<span class="string">"Hello"</span>);</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="导航"><a href="#导航" class="headerlink" title="导航"></a>导航</h1><h2 id="页面导航"><a href="#页面导航" class="headerlink" title="页面导航"></a>页面导航</h2><p>iOS 页面间转移时，使用 <code>UINavigationController</code> 管理视图控制器组成的栈。</p>
<p>Flutter 有类似的实现，<code>Navigator</code> 和 <code>Routes</code>。<code>Route</code> 是页面的抽象，<code>Navigator</code> 是管理 routes 的 widget。Route 类比 UIViewController，Navigator 类比 UINavigationController。</p>
<p>页面导航的步骤：</p>
<ul>
<li>构建一个路由表</li>
<li>直接导航到指定路由</li>
</ul>
<p>例子如下：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">    runApp(</span><br><span class="line">        CupertinoApp(</span><br><span class="line">            home: MyAppHome(),</span><br><span class="line">            routes: &lt;<span class="built_in">String</span>, WidgetBuilder&gt; &#123;</span><br><span class="line">                <span class="string">'/a'</span>: (BuildContext context) =&gt; MyPage(title: <span class="string">'page A'</span>),</span><br><span class="line">                <span class="string">'/b'</span>: (BuildContext context) =&gt; MyPage(title: <span class="string">'page B'</span>),</span><br><span class="line">                <span class="string">'/c'</span>: (BuildContext context) =&gt; MyPage(title: <span class="string">'page C'</span>),</span><br><span class="line">            &#125;,</span><br><span class="line">        )</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>调用 <code>Navigator push</code> 方法，导航到指定路由：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Navigator.of(context).pushNamed(<span class="string">'/b'</span>);</span><br></pre></td></tr></table></figure>

<p><code>Navigator</code> 处理路由事件，并得到对应路由结果。对 <code>push()</code> 返回值 <code>Future</code> 对象使用 <code>await</code>。</p>
<p>如下例子，路由到 ‘location’ 页面：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Map</span> coordinates = <span class="keyword">await</span> Navigator.of(context).pushNamed(<span class="string">'/location'</span>);</span><br></pre></td></tr></table></figure>

<p>在 ‘location’ 页内部，<code>pop()</code> 时带上结果：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Navigator.of(context).pop(&#123;<span class="string">"lat"</span>:<span class="number">43.821757</span>, <span class="string">"long"</span>:<span class="number">-79.226392</span>&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="如何导航到其他页面"><a href="#如何导航到其他页面" class="headerlink" title="如何导航到其他页面"></a>如何导航到其他页面</h2><p>iOS 中，用 URL Scheme 跳转指定应用。Flutter 中实现此功能的做法，要么创建原生平台集成，或使用 <em>existing plugin</em>，比如 <em>url_launcher</em>。</p>
<h2 id="如何返回到-iOS-原生控制器"><a href="#如何返回到-iOS-原生控制器" class="headerlink" title="如何返回到 iOS 原生控制器"></a>如何返回到 iOS 原生控制器</h2><p>调用 <code>SystemNavigator.pop()</code> 相当于以下 iOS 代码的作用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">UIViewController *viewController = [UIApplication sharedApplication].keyWindow.rootViewController;</span><br><span class="line">if ([viewController isKindOfClass:[UINavigationController class]]) &#123;</span><br><span class="line">    [(UINavigationController *)viewController popViewControllerAnimated: NO];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果上述代码不生效，可以创建 <a href="https://flutter.dev/docs/development/platform-integration/platform-channels" target="_blank" rel="noopener"><em>platform channel</em></a> 去调用任意 iOS 代码。</p>
<h1 id="线程和异步操作"><a href="#线程和异步操作" class="headerlink" title="线程和异步操作"></a>线程和异步操作</h1><h2 id="如何编写异步代码"><a href="#如何编写异步代码" class="headerlink" title="如何编写异步代码"></a>如何编写异步代码</h2><p>Dart 有一个单线程执行模型，支持 <code>Isolate</code>s（一种在其他线程执行 Dart 代码的方式），事件循环和异步编程。Dart 默认运行在主 UI 线程，此线程靠一个事件循环驱动，开发者也可以创建新的 Isolate 去执行代码。Flutter 事件循环等同于 iOS，<code>Looper</code> 依附于主线程。</p>
<p>Dart 的单线程模型并不意味着所有内容都作为阻塞操作运行，导致 UI 冻结。相反，使用 Dart 提供的异步工具（比如，<code>async</code>/<code>await</code>）去执行异步操作。</p>
<p>举例，使用 <code>async</code>/<code>await</code> 运行网络代码，从而不阻塞 UI，让 Dart 作这些繁重的工作：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">loadData() <span class="keyword">async</span> &#123;</span><br><span class="line">    <span class="built_in">String</span> dataURL = <span class="string">"https://jsonplaceholder.typicode.com/posts"</span>;</span><br><span class="line">    http.Response response = <span class="keyword">await</span> http.<span class="keyword">get</span>(dataURL);</span><br><span class="line">    setState(() &#123;</span><br><span class="line">        widgets = json.decode(response.body);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>一旦 <code>await</code> 完成，调用 <code>setState()</code> 更新 UI，此方法会触发 widget 子树的重新构建并更新数据。</p>
<p>如下例子，异步加载数据并展示到 <code>ListView</code>：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'dart:convert'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">'package:flutter/material.dart'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'package:http/http.dart'</span> <span class="keyword">as</span> http;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">    runApp(SampleApp());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SampleApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">    <span class="meta">@override</span></span><br><span class="line">    Widget build(BuildContext context) &#123;</span><br><span class="line">        <span class="keyword">return</span> MaterialApp(</span><br><span class="line">            title: <span class="string">'Sample App'</span>,</span><br><span class="line">            thme: ThemeData(</span><br><span class="line">                primarySwatch: Colors.blue,</span><br><span class="line">            ),</span><br><span class="line">            home: SampleAppPage(),</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SampleAppPage</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">    SampleAppPage(&#123;Key key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line">    <span class="meta">@override</span></span><br><span class="line">    _SampleAppPageState createState() =&gt; _SampleAppPageState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_SampleAppPageState</span> <span class="keyword">extends</span>&lt;<span class="title">SampleAppPage</span>&gt; </span>&#123;</span><br><span class="line">    <span class="built_in">List</span> widgets = [];</span><br><span class="line"></span><br><span class="line">    <span class="meta">@override</span></span><br><span class="line">    <span class="keyword">void</span> initState() &#123;</span><br><span class="line">        <span class="keyword">super</span>.initState();</span><br><span class="line">        </span><br><span class="line">        loadData();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@override</span></span><br><span class="line">    Widget build(BuildContext context) &#123;</span><br><span class="line">        <span class="keyword">return</span> Scaffold(</span><br><span class="line">            appBar: AppBar(title: Text(<span class="string">"Sample App"</span>)),</span><br><span class="line">            body: ListView.builder(</span><br><span class="line">                itemCount: widgets.length,</span><br><span class="line">                itemBuilder: (BuildContext context, <span class="built_in">int</span> position) &#123;</span><br><span class="line">                    <span class="keyword">return</span> getRow(position);</span><br><span class="line">                &#125;</span><br><span class="line">            ),</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="工程结构，本地化，依赖和资源"><a href="#工程结构，本地化，依赖和资源" class="headerlink" title="工程结构，本地化，依赖和资源"></a>工程结构，本地化，依赖和资源</h1><h2 id="Flutter-中如何使用图片资源？如何处理多分辨率？"><a href="#Flutter-中如何使用图片资源？如何处理多分辨率？" class="headerlink" title="Flutter 中如何使用图片资源？如何处理多分辨率？"></a>Flutter 中如何使用图片资源？如何处理多分辨率？</h2><p>iOS 中区别对待图片和其它资源，而 Flutter 只有资源这一概念。iOS 中防止在 <code>Image.xcasset</code> 目录下的资源，在 Flutter 中，则放在 assets 目录下。同 iOS，assets 目录可以放置任意类型的文件。例如，放置一个 JSON 文件在 <code>my-assets</code> 目录下。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">my-assets/data.json</span><br></pre></td></tr></table></figure>

<p>在 <code>pubspec.yaml</code> 文件中，声明资源路径：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">assets:</span><br><span class="line">- my-assets/data.json</span><br></pre></td></tr></table></figure>

<p>在代码中，使用 <em>AssetBundle</em> 访问资源：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'dart:async'</span> show Future;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'package:flutter/services.dart'</span> show rootBundle;</span><br><span class="line"></span><br><span class="line">Future&lt;<span class="built_in">String</span>&gt; loadString() <span class="keyword">async</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> rootBundle.loadString(<span class="string">'my-assets/data.json'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>对于图片，Flutter 同 iOS 一样采用基于屏幕密度的格式。图片资源可能是 <code>1.0x</code>, <code>2.0x</code>, <code>3.0x</code> 或其他任意倍数。<em>devicePixelRatio</em> 表示物理分辨率到逻辑分辨率的比例。</p>
<p>资源目录可以放在任意目录下（Flutter 并没有预定义目录结构）。在 <code>pubspec.yaml</code> 文件中声明资源，Flutter 就能获取到对应资源。</p>
<p>例如，添加一张 <code>my_icon.png</code> 图片，防止在任意目录下（这里命名为 <code>images</code>）。将 <code>1.0x</code> 倍数图片放在 <code>images</code> 一级目录下，将其他倍数图片放置在对应倍数的二级目录下：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">images/my_icon.png</span><br><span class="line">images/<span class="number">2.0</span>x/my_icon.png</span><br><span class="line">images/<span class="number">3.0</span>x/my_icon.png</span><br></pre></td></tr></table></figure>

<p>接着，在 <code>pubspec.yaml</code> 文件中声明：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">assets:</span><br><span class="line">- images/my_icon.png</span><br></pre></td></tr></table></figure>

<p>在代码中用 <code>AssetImage</code> 访问：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> AssetImage(<span class="string">"images/my_icon.png"</span>);</span><br></pre></td></tr></table></figure>

<p>或者直接使用 <code>Image</code> widget：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@override</span></span><br><span class="line">Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Image.asset(<span class="string">"images/my_icon.png"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>更多信息查看 <a href="https://flutter.dev/docs/development/ui/assets-and-images" target="_blank" rel="noopener">Adding Assets and Images in Flutter</a>。</p>
<h2 id="如何存储字符串？如何处理本地化？"><a href="#如何存储字符串？如何处理本地化？" class="headerlink" title="如何存储字符串？如何处理本地化？"></a>如何存储字符串？如何处理本地化？</h2><p>不同于 iOS 中的 <code>Localizable.strings</code>，Flutter 并没有专用的字符串处理系统。目前为止，最好的处理方式是，将字符串声明为类中的静态变量。例如：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Strings</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">String</span> welcomeMessage = <span class="string">'Welcome To Flutter'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如何使用字符串：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Text(Strings.welcomeMessage);</span><br></pre></td></tr></table></figure>

<p>默认情况下，Flutter 只支持美式英语。如果需要支持其他语言，添加 <code>flutter_localizations</code> 库。并且还可能需要添加 Dart <em>intl</em> 库，从而使用 i10n 机制，比如日期、时间格式。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dependencies:</span><br><span class="line">    flutter_localizations:</span><br><span class="line">        sdk: flutter</span><br><span class="line">    intl: <span class="string">"^0.15.6"</span></span><br></pre></td></tr></table></figure>

<p>如何使用 <code>flutter_localizations</code> 例子：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">MaterialApp(</span><br><span class="line">    localizationsDelegates: [</span><br><span class="line">        GlobalMaterialLocalizations.delegate,</span><br><span class="line">        GlobalWidgetsLocalizations.delegate,</span><br><span class="line">    ],</span><br><span class="line">    supportedLocales: [</span><br><span class="line">        <span class="keyword">const</span> Locale(<span class="string">'en'</span>, <span class="string">'US'</span>), <span class="comment">// English</span></span><br><span class="line">        <span class="keyword">const</span> Locale(<span class="string">'he'</span>, <span class="string">'IL'</span>), <span class="comment">// Hebrew</span></span><br><span class="line">    <span class="comment">// ... other locales the app supports</span></span><br><span class="line">    ],</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><code>supportedLocales</code> 指定应用支持的语言，<code>localizationsDelegates</code> 保存实际的本地化值。应用使用 <code>MaterialApp</code>，<code>GlobalWidgetsLocalizations</code> 指定基础的 widgets 本地化值；<code>MaterialWidgetsLocalizations</code> 指定 material widgets 值。如果应用使用 <code>WidgetsApp</code>，不需要指定后者。除了以上两个代理提供的默认值，还可以自定义本地化值。</p>
<p>当初始化的时候，WidgetsApp(或 MaterialApp) 会根据你提供的 delegates 创建一个 Localizations widget。<code>Localizations</code> 可以随时从当前上下文中获取设备的语言，也可使用 <code>Window.locale</code>。</p>
<p>通过已知代理的 <code>Localizations.of()</code> 方法获取指定的本地化类，从而获取本地化资源。使用 <a href="https://pub.dev/packages/intl_translation" target="_blank" rel="noopener">intl_translation</a> 库提取拷贝出来的信息至 <a href="https://github.com/googlei18n/app-resource-bundle" target="_blank" rel="noopener">arb</a> 文件以供翻译，并用 <code>intl</code> 重新将结果导入到应用中以供使用。</p>
<p>想了解 Flutter 中的国际化和本地化详情，查看 <a href="https://flutter.dev/docs/development/accessibility-and-localization/internationalization" target="_blank" rel="noopener">internationalization guide</a>，其中有 intl 和 无 intl 两个版本的样例代码。</p>
<p>在 Flutter 1.0 beta 2 之前，Flutter 资源和原生资源是不可互通的，因为他们在不同的目录下。</p>
<h2 id="CocoaPods-的替代品？如何添加依赖？"><a href="#CocoaPods-的替代品？如何添加依赖？" class="headerlink" title="CocoaPods 的替代品？如何添加依赖？"></a>CocoaPods 的替代品？如何添加依赖？</h2><p>iOS 中，在 <code>Podfile</code> 中添加依赖信息。Flutter 使用 Dart 的构建系统和 Pub 包管理来处理依赖。这些工具会将原生 iOS 和 Android 构建任务代理给各自的构建系统。</p>
<p>如果 Flutter 工程中 iOS 目录下使用 CocoaPods，请尽在单独平台需要的情况下，再使用 Podfile 添加依赖。通常情况下，在 <code>pubspec.yaml</code> 中声明依赖。<a href="https://pub.dev/flutter/packages" target="_blank" rel="noopener">Pub site</a> 用于查询 Flutter 中可供使用的库。</p>
<h1 id="视图控制器"><a href="#视图控制器" class="headerlink" title="视图控制器"></a>视图控制器</h1><h2 id="Flutter-中视图控制器的替代品"><a href="#Flutter-中视图控制器的替代品" class="headerlink" title="Flutter 中视图控制器的替代品"></a>Flutter 中视图控制器的替代品</h2><p>iOS 中，用户界面的一部分，通常是一个屏幕或者是一部分。多个控制器组合在一起构建复杂的用户界面，并帮助扩展应用的 UI。Flutter 中，widgets 做了相同的工作。正如导航章节中所说的，Flutter 的屏幕是通过 widgets 展现。使用 <code>Navigator</code> 在不同的路由间转移，或者状态的变迁。</p>
<h2 id="如何监听-iOS-生命周期事件"><a href="#如何监听-iOS-生命周期事件" class="headerlink" title="如何监听 iOS 生命周期事件"></a>如何监听 iOS 生命周期事件</h2><p>iOS 中，重写 <code>ViewController</code> 的生命周期方法，以获取视图的生命周期过程，或在 <code>AppDelegate</code> 中注册生命周期回调。Flutter 中并没有上述的概念，但可以通过 hook <code>WidgetsBinding</code> 观察者以监听事件；还可以监听 <code>didChangeAppLifecycleState()</code> 事件。</p>
<p>可观察的生命周期事件：</p>
<ul>
<li><code>inactive</code>：应用处于非活跃状态，且不会接受用户输入。此事件仅在 iOS 平台可用，安卓平台并无类似事件</li>
<li><code>paused</code>：当用当前对用户不可见，并不会响应用户输入，但仍然在后台运行</li>
<li><code>resumed</code>：应用可见且可接受用户输入</li>
<li><code>suspending</code>：应用暂时挂起。iOS 并无相同事件。</li>
</ul>
<p>查看更多关于上述状态的信息，请查看 <a href="https://api.flutter.dev/flutter/dart-ui/AppLifecycleState-class.html" target="_blank" rel="noopener">AppLifecycleStatus documentation</a>。</p>
<h1 id="布局"><a href="#布局" class="headerlink" title="布局"></a>布局</h1><h2 id="Flutter-中-UITableView-和-UICollectionView-的替代品"><a href="#Flutter-中-UITableView-和-UICollectionView-的替代品" class="headerlink" title="Flutter 中 UITableView 和 UICollectionView 的替代品"></a>Flutter 中 UITableView 和 UICollectionView 的替代品</h2><p>Flutter 中用 <code>ListView</code> 替代 <code>UITableView</code> 和 <code>UICollectionView</code>。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'package:flutter/material.dart";</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">void main() &#123;</span></span><br><span class="line"><span class="string">    runApp(SampleApp());</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">class SampleApp extends StatelessWidget &#123;</span></span><br><span class="line"><span class="string">    @override</span></span><br><span class="line"><span class="string">    Widget build(BuildContext build) &#123;</span></span><br><span class="line"><span class="string">        return MaterialApp(</span></span><br><span class="line"><span class="string">            title: '</span>Sample App<span class="string">',</span></span><br><span class="line"><span class="string">            theme: ThemeData(</span></span><br><span class="line"><span class="string">                primarySwatch: Colors.blue,</span></span><br><span class="line"><span class="string">            ),</span></span><br><span class="line"><span class="string">            home: SampleAppPage(),</span></span><br><span class="line"><span class="string">        );</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">class SampleAppPage extends StatefulWidget &#123;</span></span><br><span class="line"><span class="string">    SampleAppPage(&#123;Key: key&#125;) : super(key: key);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    @override</span></span><br><span class="line"><span class="string">    _SampleAppPageState createState() =&gt; _SampleAppPageState();</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">class _SampleAppPageState extends State&lt;SampleAppPage&gt; &#123;</span></span><br><span class="line"><span class="string">    @ovrride</span></span><br><span class="line"><span class="string">    Widget build(BuildContext build) &#123;</span></span><br><span class="line"><span class="string">        return Scaffold(</span></span><br><span class="line"><span class="string">            appBar: AppBar(title: Text("Sample App")),</span></span><br><span class="line"><span class="string">            body: ListView(children: _getListData()),</span></span><br><span class="line"><span class="string">        );</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    _getListData() &#123;</span></span><br><span class="line"><span class="string">        List&lt;Widget&gt; widgets = [];</span></span><br><span class="line"><span class="string">        for (int i = 0; i &lt; 100; i++) &#123;</span></span><br><span class="line"><span class="string">            widgets.add(Padding(padding: EdgeInsets.all(10, 10, 10, 10), child: Text("Row $i")));</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        return widgets;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="ListView-列表选中"><a href="#ListView-列表选中" class="headerlink" title="ListView 列表选中"></a>ListView 列表选中</h2><p>iOS 有 UITableView 的代理方法 <code>tableView:didSelectRowAtIndexPath:</code>。Flutter 有手势检测元素 <code>GestureDetector</code>：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'package:flutter/material.dart";</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">void main() &#123;</span></span><br><span class="line"><span class="string">    runApp(SampleApp());</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">class SampleApp extends StatelessWidget &#123;</span></span><br><span class="line"><span class="string">    @override</span></span><br><span class="line"><span class="string">    Widget build(BuildContext build) &#123;</span></span><br><span class="line"><span class="string">        return MaterialApp(</span></span><br><span class="line"><span class="string">            title: '</span>Sample App<span class="string">',</span></span><br><span class="line"><span class="string">            theme: ThemeData(</span></span><br><span class="line"><span class="string">                primarySwatch: Colors.blue,</span></span><br><span class="line"><span class="string">            ),</span></span><br><span class="line"><span class="string">            home: SampleAppPage(),</span></span><br><span class="line"><span class="string">        );</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">class SampleAppPage extends StatefulWidget &#123;</span></span><br><span class="line"><span class="string">    SampleAppPage(&#123;Key: key&#125;) : super(key: key);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    @override</span></span><br><span class="line"><span class="string">    _SampleAppPageState createState() =&gt; _SampleAppPageState();</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">class _SampleAppPageState extends State&lt;SampleAppPage&gt; &#123;</span></span><br><span class="line"><span class="string">    @ovrride</span></span><br><span class="line"><span class="string">    Widget build(BuildContext build) &#123;</span></span><br><span class="line"><span class="string">        return Scaffold(</span></span><br><span class="line"><span class="string">            appBar: AppBar(title: Text("Sample App")),</span></span><br><span class="line"><span class="string">            body: ListView(children: _getListData()),</span></span><br><span class="line"><span class="string">        );</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    _getListData() &#123;</span></span><br><span class="line"><span class="string">        List&lt;Widget&gt; widgets = [];</span></span><br><span class="line"><span class="string">        for (int i = 0; i &lt; 100; i++) &#123;</span></span><br><span class="line"><span class="string">            widgets.add(</span></span><br><span class="line"><span class="string">                GesutreDetector(</span></span><br><span class="line"><span class="string">                    child: Padding(</span></span><br><span class="line"><span class="string">                        padding: EdgeInsets.all(10, 10, 10, 10),</span></span><br><span class="line"><span class="string">                        child: Text("Row $i"),</span></span><br><span class="line"><span class="string">                    ),</span></span><br><span class="line"><span class="string">                    onTap: () &#123;</span></span><br><span class="line"><span class="string">                        print('</span>row tapped<span class="string">');</span></span><br><span class="line"><span class="string">                    &#125;</span></span><br><span class="line"><span class="string">                )</span></span><br><span class="line"><span class="string">            );</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        return widgets;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="如何动态更新-ListView"><a href="#如何动态更新-ListView" class="headerlink" title="如何动态更新 ListView"></a>如何动态更新 ListView</h2><p>iOS 中，更新表视图数据源，并调用对应的 <code>reloadData</code> 方法刷新。</p>
<p>Flutter 中，如果你在 <code>setState()</code> 内部更行了 widgets，你会发现页面并没有刷新。因为调用 <code>setState()</code> 方法后，Flutter 渲染引擎回去检索 widgets 树，比对是否有更新。当检索到 ListView 时，使用 <code>==</code> 校验，发现两个 <code>ListView</code> 是相等的，于是不会刷新页面。</p>
<p>一个简单更新 <code>ListView</code> 的方法：在 <code>setState()</code> 内部创建新的 <code>List</code>，并将老的数据拷贝到新数组内。虽然这个方法很简单，但是并不推荐在大量数据的情况下使用：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'package:flutter/material.dart'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  runApp(SampleApp());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SampleApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="comment">// This widget is the root of your application.</span></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> MaterialApp(</span><br><span class="line">      title: <span class="string">'Sample App'</span>,</span><br><span class="line">      theme: ThemeData(</span><br><span class="line">        primarySwatch: Colors.blue,</span><br><span class="line">      ),</span><br><span class="line">      home: SampleAppPage(),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SampleAppPage</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  SampleAppPage(&#123;Key key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  _SampleAppPageState createState() =&gt; _SampleAppPageState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_SampleAppPageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">SampleAppPage</span>&gt; </span>&#123;</span><br><span class="line">  <span class="built_in">List</span> widgets = [];</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">      widgets.add(getRow(i));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: Text(<span class="string">"Sample App"</span>),</span><br><span class="line">      ),</span><br><span class="line">      body: ListView(children: widgets),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Widget getRow(<span class="built_in">int</span> i) &#123;</span><br><span class="line">    <span class="keyword">return</span> GestureDetector(</span><br><span class="line">      child: Padding(</span><br><span class="line">        padding: EdgeInsets.all(<span class="number">10.0</span>),</span><br><span class="line">        child: Text(<span class="string">"Row $i"</span>),</span><br><span class="line">      ),</span><br><span class="line">      onTap: () &#123;</span><br><span class="line">        setState(() &#123;</span><br><span class="line">          widgets = <span class="built_in">List</span>.from(widgets);</span><br><span class="line">          widgets.add(getRow(widgets.length + <span class="number">1</span>));</span><br><span class="line">          <span class="built_in">print</span>(<span class="string">'row $i'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;,</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>下面推荐一个高效、强大的方法，使用 <code>ListView.Builder</code>。当你需要处理动态的数组变化或大数组的时候，这个方法非常好用：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'package:flutter/material.dart'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  runApp(SampleApp());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SampleApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="comment">// This widget is the root of your application.</span></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> MaterialApp(</span><br><span class="line">      title: <span class="string">'Sample App'</span>,</span><br><span class="line">      theme: ThemeData(</span><br><span class="line">        primarySwatch: Colors.blue,</span><br><span class="line">      ),</span><br><span class="line">      home: SampleAppPage(),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SampleAppPage</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  SampleAppPage(&#123;Key key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  _SampleAppPageState createState() =&gt; _SampleAppPageState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_SampleAppPageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">SampleAppPage</span>&gt; </span>&#123;</span><br><span class="line">  <span class="built_in">List</span> widgets = [];</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">      widgets.add(getRow(i));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: Text(<span class="string">"Sample App"</span>),</span><br><span class="line">      ),</span><br><span class="line">      body: ListView.builder(</span><br><span class="line">        itemCount: widgets.length,</span><br><span class="line">        itemBuilder: (BuildContext context, <span class="built_in">int</span> position) &#123;</span><br><span class="line">          <span class="keyword">return</span> getRow(position);</span><br><span class="line">        &#125;,</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Widget getRow(<span class="built_in">int</span> i) &#123;</span><br><span class="line">    <span class="keyword">return</span> GestureDetector(</span><br><span class="line">      child: Padding(</span><br><span class="line">        padding: EdgeInsets.all(<span class="number">10.0</span>),</span><br><span class="line">        child: Text(<span class="string">"Row $i"</span>),</span><br><span class="line">      ),</span><br><span class="line">      onTap: () &#123;</span><br><span class="line">        setState(() &#123;</span><br><span class="line">          widgets.add(getRow(widgets.length + <span class="number">1</span>));</span><br><span class="line">          <span class="built_in">print</span>(<span class="string">'row $i'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;,</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>用 <code>ListView.Builder</code> 实例替代 ListView 实例，用两个参数初始化：数组初始长度和 <code>ItemBuilder</code> 函数。</p>
<p><code>ItemBuilder</code> 函数类似 iOS 中 <code>cellForRowAt</code> 方法，携带一个索引，并返回在指定索引要展示的 cell。</p>
<p>最后，最重要的是，<code>onTap()</code> 方法内部并不会重新创建一个数组，而是用 <code>.add</code> 拼接元素。</p>
<h2 id="ScrollView-替代品"><a href="#ScrollView-替代品" class="headerlink" title="ScrollView 替代品"></a>ScrollView 替代品</h2><p>iOS 中，将元素添加到 <code>ScrollView</code> 中，使得用户能滚动视图。</p>
<p>Flutter 中，完成此功能最简单的方式就是用 <code>ListView</code>。它既是 <code>ScrollView</code> 又是 <code>TableView</code>，让你可在竖直方向上布局 widgets：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@override</span></span><br><span class="line">Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> ListView(</span><br><span class="line">        children: &lt;Widget&gt;[</span><br><span class="line">            Text(<span class="string">'Row One'</span>),</span><br><span class="line">            Text(<span class="string">'Row Two'</span>),</span><br><span class="line">            Text(<span class="string">'Row Three'</span>),</span><br><span class="line">        ],</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>更多关于如何布局的信息请查看 <a href="https://flutter.dev/docs/development/ui/widgets/layout" target="_blank" rel="noopener">layout tutorial</a>。</p>
<h1 id="手势检测和触摸事件处理"><a href="#手势检测和触摸事件处理" class="headerlink" title="手势检测和触摸事件处理"></a>手势检测和触摸事件处理</h1><h2 id="如何添加个点击监听"><a href="#如何添加个点击监听" class="headerlink" title="如何添加个点击监听"></a>如何添加个点击监听</h2><p>iOS 中，在 view 上添加 <code>GestureRecognizer</code> 以处理点击事件。Flutter 中，有两种方法添加触摸监听：</p>
<ol>
<li><p>如果 widget 本身支持事件监测，传递一个函数作为参数，在函数内处理事件。例如，<code>RaisedButton</code> widget 有一个 <code>onPressed</code> 参数：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@override</span></span><br><span class="line">Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> RaisedButton(</span><br><span class="line">        child: Text(<span class="string">'Button'</span>),</span><br><span class="line">        onPressed: () &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">'Pressed'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果 widget 本身并不支持事件监测，将 widget 封装在一个 <code>GestureDetector</code> 中，并传一个函数到 <code>onTap</code> 参数。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SampleApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">    <span class="meta">@override</span></span><br><span class="line">    Widget build(BuildContext context) &#123;</span><br><span class="line">        <span class="keyword">return</span> Scaffold(</span><br><span class="line">            body: Center(</span><br><span class="line">                child: GestureDetector(</span><br><span class="line">                    onTap: () &#123;</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">'tap'</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    child: FlutterLogo(</span><br><span class="line">                        size: <span class="number">200</span>,</span><br><span class="line">                    ),</span><br><span class="line">                ),</span><br><span class="line">            ),</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="如何-widgets-上的其它事件"><a href="#如何-widgets-上的其它事件" class="headerlink" title="如何 widgets 上的其它事件"></a>如何 widgets 上的其它事件</h2><p>使用 <code>GestureDetector</code> 可以监听大量手势：</p>
<ul>
<li>单击<ul>
<li><code>onTapDown</code>：用户在屏幕指定区域点击的操作</li>
<li><code>onTapUp</code>：用户在屏幕指定区域抬起的的操作</li>
<li><code>onTap</code>：点击发生</li>
<li><code>onTapCancel</code>：之前的点击手势没有生效</li>
</ul>
</li>
<li>双击<ul>
<li><code>onDoubleTap</code>：用户在短时间内两次点击同意位置</li>
</ul>
</li>
<li>长按<ul>
<li><code>onLongPress</code>：用户长时间按在屏幕上的一个位置</li>
</ul>
</li>
<li>竖直拖动<ul>
<li><code>onVerticalDragStart</code>：手指在屏幕上并开始竖直滑动</li>
<li><code>onVerticalDragUpdate</code>：手指在屏幕上并在竖直方向上滑动一段距离</li>
<li><code>onVerticalDargEnd</code>：手指之前在屏幕上竖直滑动并在停止接触前还以一定的速率移动</li>
</ul>
</li>
<li>水平拖动<ul>
<li><code>onHorizontalDragStart</code>：手指放在屏幕上并准备开始水平移动</li>
<li><code>onHorizontalDargUpdate</code>：手指在屏幕上并在水平方向上移动一段距离</li>
<li><code>onHorizontalDragEnd</code>：手指之前在屏幕上水平移动接着离开屏幕</li>
</ul>
</li>
</ul>
<p>如下例子展示了 <code>GestureDetector</code> 双击事件旋转 Flutter logo：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">AnimationController controller;</span><br><span class="line">CurvedAnimation curve;</span><br><span class="line"></span><br><span class="line"><span class="meta">@override</span></span><br><span class="line"><span class="keyword">void</span> initState() &#123;</span><br><span class="line">  controller = AnimationController(duration: <span class="keyword">const</span> <span class="built_in">Duration</span>(milliseconds: <span class="number">2000</span>), vsync: <span class="keyword">this</span>);</span><br><span class="line">  curve = CurvedAnimation(parent: controller, curve: Curves.easeIn);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SampleApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      body: Center(</span><br><span class="line">        child: GestureDetector(</span><br><span class="line">          child: RotationTransition(</span><br><span class="line">            turns: curve,</span><br><span class="line">            child: FlutterLogo(</span><br><span class="line">              size: <span class="number">200.0</span>,</span><br><span class="line">            )),</span><br><span class="line">          onDoubleTap: () &#123;</span><br><span class="line">            <span class="keyword">if</span> (controller.isCompleted) &#123;</span><br><span class="line">              controller.reverse();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              controller.forward();</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="主题化和文本"><a href="#主题化和文本" class="headerlink" title="主题化和文本"></a>主题化和文本</h1><h2 id="如何为应用创建主题"><a href="#如何为应用创建主题" class="headerlink" title="如何为应用创建主题"></a>如何为应用创建主题</h2><p>Flutter 对 Material Design 有一个优雅的实现，为开发者提供丰富的风格和主题选项。</p>
<p>为了充分利用 Material 组件的特点，在应用入口处声明 MaterialApp 为顶级 widget。MaterialApp 封装了大量 Material 设计风格的 widget，避免了开发者自己手动实现。它基于 WidgetApp 构建并添加了 Material 指定的功能。</p>
<p>然而，Flutter 仍然足够灵活以实现其他设计风格。iOS 平台可以使用 <a href="https://api.flutter.dev/flutter/cupertino/cupertino-library.html" target="_blank" rel="noopener">Cupertino 库</a>生成符合 <a href="https://developer.apple.com/ios/human-interface-guidelines/overview/themes/" target="_blank" rel="noopener">Human Interface Guidelines</a> 风格的界面。查看此类型的 widgets，查看 <a href="https://flutter.dev/docs/development/ui/widgets/cupertino" target="_blank" rel="noopener">Cupertino widgets gallery</a>。</p>
<p>也可使用 <code>WidgetApp</code> 作为顶级 widget，提供了部分 <code>MaterialApp</code> 功能。</p>
<p>自定义任意子组件的颜色和风格，给 <code>MaterialApp</code> 传一个 <code>ThemeData</code> 对象。如下代码，主要的样本设置为蓝色以及文本选中颜色为红色。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SampleApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> MaterialApp(</span><br><span class="line">      title: <span class="string">'Sample App'</span>,</span><br><span class="line">      theme: ThemeData(</span><br><span class="line">        primarySwatch: Colors.blue,</span><br><span class="line">        textSelectionColor: Colors.red</span><br><span class="line">      ),</span><br><span class="line">      home: SampleAppPage(),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="为-Text-自定义字体"><a href="#为-Text-自定义字体" class="headerlink" title="为 Text 自定义字体"></a>为 Text 自定义字体</h2><p>iOS 中，在工程导入任意 <code>ttf</code> 字体文件，并在 <code>info.plist</code> 中创建引用。Flutter 中，做法类似导入图片，将字体文件放置在一个目录下，并在 <code>pubspec.yaml</code> 文件中引用。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fonts:</span><br><span class="line">   - family: MyCustomFont</span><br><span class="line">     fonts:</span><br><span class="line">       - asset: fonts/MyCustomFont.ttf</span><br><span class="line">       - style: italic</span><br></pre></td></tr></table></figure>

<p>代码中，为 <code>Text</code> widget 指定字体：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@override</span></span><br><span class="line">Widget build(BuildContext context) &#123;</span><br><span class="line">  <span class="keyword">return</span> Scaffold(</span><br><span class="line">    appBar: AppBar(</span><br><span class="line">      title: Text(<span class="string">"Sample App"</span>),</span><br><span class="line">    ),</span><br><span class="line">    body: Center(</span><br><span class="line">      child: Text(</span><br><span class="line">        <span class="string">'This is a custom font text'</span>,</span><br><span class="line">        style: TextStyle(fontFamily: <span class="string">'MyCustomFont'</span>),</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="自定义-Text-风格"><a href="#自定义-Text-风格" class="headerlink" title="自定义 Text 风格"></a>自定义 Text 风格</h2><p>和字体一样，你也可以为 <code>Text</code> 自定义其它元素风格。<code>Text</code> 有一个风格参数，携带 <code>TextStyle</code> 对象，你可以在此对象中自定义大量参数：</p>
<ul>
<li><code>color</code></li>
<li><code>decoration</code></li>
<li><code>decorationColor</code></li>
<li><code>decorationStyle</code></li>
<li><code>fontFamily</code></li>
<li><code>fontSize</code></li>
<li><code>fontStyle</code></li>
<li><code>fontWeight</code></li>
<li><code>hashCode</code></li>
<li><code>height</code></li>
<li><code>inherit</code></li>
<li><code>letterSpacing</code></li>
<li><code>textBaseline</code></li>
<li><code>wordSpacing</code></li>
</ul>
<h1 id="表单输入"><a href="#表单输入" class="headerlink" title="表单输入"></a>表单输入</h1><h2 id="Flutter-中如何使用表单？如何获取用户输入？"><a href="#Flutter-中如何使用表单？如何获取用户输入？" class="headerlink" title="Flutter 中如何使用表单？如何获取用户输入？"></a>Flutter 中如何使用表单？如何获取用户输入？</h2><p>Flutter 中有用于处理表单的特殊 widgets。如果使用 <code>TextField</code> 或 <code>TextFormField</code>，可以指定 <a href="https://api.flutter.dev/flutter/widgets/TextEditingController-class.html" target="_blank" rel="noopener">TextEditingController</a> 去获取用户输入：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_MyFormState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">MyForm</span>&gt; </span>&#123;</span><br><span class="line">  <span class="comment">// Create a text controller and use it to retrieve the current value.</span></span><br><span class="line">  <span class="comment">// of the TextField!</span></span><br><span class="line">  <span class="keyword">final</span> myController = TextEditingController();</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    <span class="comment">// Clean up the controller when disposing of the Widget.</span></span><br><span class="line">    myController.dispose();</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: Text(<span class="string">'Retrieve Text Input'</span>),</span><br><span class="line">      ),</span><br><span class="line">      body: Padding(</span><br><span class="line">        padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">16.0</span>),</span><br><span class="line">        child: TextField(</span><br><span class="line">          controller: myController,</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">      floatingActionButton: FloatingActionButton(</span><br><span class="line">        <span class="comment">// When the user presses the button, show an alert dialog with the</span></span><br><span class="line">        <span class="comment">// text the user has typed into our text field.</span></span><br><span class="line">        onPressed: () &#123;</span><br><span class="line">          <span class="keyword">return</span> showDialog(</span><br><span class="line">            context: context,</span><br><span class="line">            builder: (context) &#123;</span><br><span class="line">              <span class="keyword">return</span> AlertDialog(</span><br><span class="line">                <span class="comment">// Retrieve the text the user has typed in using our</span></span><br><span class="line">                <span class="comment">// TextEditingController</span></span><br><span class="line">                content: Text(myController.text),</span><br><span class="line">              );</span><br><span class="line">            &#125;,</span><br><span class="line">          );</span><br><span class="line">        &#125;,</span><br><span class="line">        tooltip: <span class="string">'Show me the value!'</span>,</span><br><span class="line">        child: Icon(Icons.text_fields),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>你可以在 <a href="https://flutter.dev/docs/cookbook" target="_blank" rel="noopener">Flutter Cookbook</a> 中的 <a href="https://flutter.dev/docs/cookbook/forms/retrieve-input" target="_blank" rel="noopener">Retrieve the value of a text field</a> 中查看更多信息以及全部代码。</p>
<h2 id="Text-field-占位文字的替代品？"><a href="#Text-field-占位文字的替代品？" class="headerlink" title="Text field 占位文字的替代品？"></a>Text field 占位文字的替代品？</h2><p>Flutter 中，为 <code>Text</code> widget 提供一个 <code>InputDecoration</code> 对象作为构造器 decoration 参数，以实现占位文本的效果。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">body: Center(</span><br><span class="line">  child: TextField(</span><br><span class="line">    decoration: InputDecoration(hintText: <span class="string">"This is a hint"</span>),</span><br><span class="line">  ),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h2 id="如何展示校验错误？"><a href="#如何展示校验错误？" class="headerlink" title="如何展示校验错误？"></a>如何展示校验错误？</h2><p>同构造器参数 decoration 中提供 “hint” 一样。</p>
<p>然而，你不会想要刚开始就显示错误，而是，当用户输入非法数据时，更细状态，把那个传入一个新的 <code>Inputdecoration</code> 对象。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SampleApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="comment">// This widget is the root of your application.</span></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> MaterialApp(</span><br><span class="line">      title: <span class="string">'Sample App'</span>,</span><br><span class="line">      theme: ThemeData(</span><br><span class="line">        primarySwatch: Colors.blue,</span><br><span class="line">      ),</span><br><span class="line">      home: SampleAppPage(),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SampleAppPage</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  SampleAppPage(&#123;Key key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  _SampleAppPageState createState() =&gt; _SampleAppPageState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_SampleAppPageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">SampleAppPage</span>&gt; </span>&#123;</span><br><span class="line">  <span class="built_in">String</span> _errorText;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: Text(<span class="string">"Sample App"</span>),</span><br><span class="line">      ),</span><br><span class="line">      body: Center(</span><br><span class="line">        child: TextField(</span><br><span class="line">          onSubmitted: (<span class="built_in">String</span> text) &#123;</span><br><span class="line">            setState(() &#123;</span><br><span class="line">              <span class="keyword">if</span> (!isEmail(text)) &#123;</span><br><span class="line">                _errorText = <span class="string">'Error: This is not an email'</span>;</span><br><span class="line">              &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                _errorText = <span class="keyword">null</span>;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;,</span><br><span class="line">          decoration: InputDecoration(hintText: <span class="string">"This is a hint"</span>, errorText: _getErrorText()),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  _getErrorText() &#123;</span><br><span class="line">    <span class="keyword">return</span> _errorText;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">bool</span> isEmail(<span class="built_in">String</span> emailString) &#123;</span><br><span class="line">    <span class="built_in">String</span> emailRegexp =</span><br><span class="line">        <span class="string">r'^(([^&lt;&gt;()[\]\\.,;:\s@\"]+(\.[^&lt;&gt;()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]&#123;1,3&#125;\.[0-9]&#123;1,3&#125;\.[0-9]&#123;1,3&#125;\.[0-9]&#123;1,3&#125;\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]&#123;2,&#125;))$'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">RegExp</span> regExp = <span class="built_in">RegExp</span>(emailRegexp);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> regExp.hasMatch(emailString);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="硬件交互，第三方服务和平台"><a href="#硬件交互，第三方服务和平台" class="headerlink" title="硬件交互，第三方服务和平台"></a>硬件交互，第三方服务和平台</h1><h2 id="如何与平台以及原生代码交互"><a href="#如何与平台以及原生代码交互" class="headerlink" title="如何与平台以及原生代码交互"></a>如何与平台以及原生代码交互</h2><p>Flutter 并不直接在平台上运行代码，而是直接用 Dart 代码原生运行在设备上，绕过平台指定的 SDK 限制。例如，当你用 Dart 发起一个网络请求，该请求直接运行在 Dart 上下文。而不是调用 iOS 或 Android 的 API。你的 Flutter 应用仍然被原生平台的 <code>ViewController</code> 作为一个视图管理，但并不直接访问 <code>ViewController</code> 或者原生框架。</p>
<p>这并不意味着 Flutter 应用不能与原生 API 或原生代码交互。Flutter 提供 platform channels 和宿主 <code>ViewController</code> 互相交流及交换数据。Platform channels 实质上是异步消息机制，以桥接 Dart 代码和宿主 <code>ViewController</code>。开发者可以使用 platform channels 在原生端执行方法，或者从设备感应器获取数据。</p>
<p>除了直接使用 platform channels，也可使用预先定义的<a href="https://flutter.dev/docs/development/packages-and-plugins/using-packages" target="_blank" rel="noopener">插件</a>（为某个目标封装的原生和 Dart 代码）。例如，Flutter 中直接用插件获取相册和设备相机，而不需要编写集成代码。<a href="https://pub.dev/" target="_blank" rel="noopener">Pub site</a> 提供查找插件，Dart 和 Flutter 开源库。一些库可能只支持一个平台或多个平台。</p>
<p>如果在 Pub 上找不到满足需求的插件，可<a href="https://flutter.dev/docs/development/packages-and-plugins/developing-packages" target="_blank" rel="noopener">自行编写</a>并<a href="https://flutter.dev/docs/development/packages-and-plugins/developing-packages#publish" target="_blank" rel="noopener">发布到 Pub</a>。</p>
<h2 id="如何获取-GPS-感应器？"><a href="#如何获取-GPS-感应器？" class="headerlink" title="如何获取 GPS 感应器？"></a>如何获取 GPS 感应器？</h2><p>使用 <a href="https://pub.dev/packages/geolocator" target="_blank" rel="noopener">deolocator</a> 社区插件。</p>
<h2 id="如何获取相机？"><a href="#如何获取相机？" class="headerlink" title="如何获取相机？"></a>如何获取相机？</h2><p><a href="https://pub.dev/packages/image_picker" target="_blank" rel="noopener">image_picker</a> 是使用广泛的获取相机插件。</p>
<h2 id="如何使用-FB-登录？"><a href="#如何使用-FB-登录？" class="headerlink" title="如何使用 FB 登录？"></a>如何使用 FB 登录？</h2><p>使用 <a href="https://pub.dev/packages/flutter_facebook_login" target="_blank" rel="noopener">flutter_facebook_login</a> 集成 FB 登录。</p>
<h2 id="如何使用-Firebase-特性？"><a href="#如何使用-Firebase-特性？" class="headerlink" title="如何使用 Firebase 特性？"></a>如何使用 Firebase 特性？</h2><p><a href="https://pub.dev/flutter/packages?q=firebase" target="_blank" rel="noopener">First party plugins</a> 包含了大多数 Firebase 功能。这些插件是 Flutter 团队开发维护。</p>
<h2 id="如果构建自定义原生集成？"><a href="#如果构建自定义原生集成？" class="headerlink" title="如果构建自定义原生集成？"></a>如果构建自定义原生集成？</h2><p><a href="https://flutter.dev/docs/development/packages-and-plugins/developing-packages" target="_blank" rel="noopener">自行开发库或插件</a>。</p>
<p>Flutter 插件架构类似 Android 的 Event bus：发送一个消息，并让接受者处理然后发挥一个结果。此时，接受者运行消息在 iOS 或 Android 原生。</p>
<h1 id="数据库和本地存储"><a href="#数据库和本地存储" class="headerlink" title="数据库和本地存储"></a>数据库和本地存储</h1><h2 id="如何访问-UserDefault？"><a href="#如何访问-UserDefault？" class="headerlink" title="如何访问 UserDefault？"></a>如何访问 UserDefault？</h2><p>iOS 中，<code>UserDefault</code> 用于保存多个键值对到属性列表文件中。</p>
<p>Flutter 中，使用 <a href="https://pub.dev/packages/shared_preferences" target="_blank" rel="noopener">Shared Preferences plugin</a> 获取相同的功能。此插件封装了 iOS 的 <code>UserDefault</code> 和 Android 的 <code>SharedPreferences</code>。</p>
<h2 id="CoreData-的替代品？"><a href="#CoreData-的替代品？" class="headerlink" title="CoreData 的替代品？"></a>CoreData 的替代品？</h2><p>iOS 中，使用 CoreData 存储结构化数据。这是基于 SQL 数据库的一层封装，使得较为容易地进行和模型相关的查询。</p>
<p>Flutter 中，用 <a href="https://pub.dev/packages/sqflite" target="_blank" rel="noopener">SQFlite</a> 插件获取此功能。</p>
<h1 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h1><h2 id="Flutter-app-调试工具？"><a href="#Flutter-app-调试工具？" class="headerlink" title="Flutter app 调试工具？"></a>Flutter app 调试工具？</h2><p>使用 DevTools 套件调试 Flutter 或 Dart 应用。</p>
<p>DevTools 支持 profiling，检查堆栈，检视 widget 树，记录诊断日志，调试，观察代码执行行数，调试内存泄露和内存碎片等。更多信息查看 <a href="https://flutter.dev/docs/development/tools/devtools" target="_blank" rel="noopener">DevTools</a> 文档。</p>
<h1 id="通知推送"><a href="#通知推送" class="headerlink" title="通知推送"></a>通知推送</h1><h2 id="如何设置推送消息？"><a href="#如何设置推送消息？" class="headerlink" title="如何设置推送消息？"></a>如何设置推送消息？</h2><p>iOS 需要在开发者中心注册应用。</p>
<p>Flutter 中，使用 <code>firebase_messaging</code> 插件获取推送功能。</p>
<p>关于 Firebase Cloud Messaging API 查看 <a href="https://pub.dev/packages/firebase_messaging" target="_blank" rel="noopener">firebase_messageing</a> 插件文档。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kaynewbie.github.io/2019/07/28/flutter-for-ios-developers/" data-id="cjyn1jpgy0000fsxp9b3f4e5f" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dart/">dart</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/flutter/">flutter</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ios/">ios</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2019/07/24/A-tour-of-the-dart-language/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Dart 入门 (译)</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/dart/">dart</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flutter/">flutter</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ios/">ios</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/dart/" style="font-size: 20px;">dart</a> <a href="/tags/flutter/" style="font-size: 20px;">flutter</a> <a href="/tags/ios/" style="font-size: 10px;">ios</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/07/28/flutter-for-ios-developers/">iOS 开发者入坑 Flutter 只是迁移(译)</a>
          </li>
        
          <li>
            <a href="/2019/07/24/A-tour-of-the-dart-language/">Dart 入门 (译)</a>
          </li>
        
          <li>
            <a href="/2019/07/21/cell_高度自适应/">(no title)</a>
          </li>
        
          <li>
            <a href="/2019/07/21/lldb/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 Kai<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>